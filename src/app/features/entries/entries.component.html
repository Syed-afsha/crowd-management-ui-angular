<div class="entries">
  <div class="section-header">
    <h2>Overview</h2>
    <button class="date-picker-btn">
      <mat-icon class="calendar-icon">calendar_today</mat-icon>
      <span>Today</span>
    </button>
  </div>

  <div *ngIf="loading" class="loading">Loading...</div>

  <div *ngIf="!loading" class="table-container">
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Sex</th>
          <th>Entry</th>
          <th>Exit</th>
          <th>Dwell Time</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let r of records; trackBy: trackByRecordId">
          <td>
            <div class="user-cell">
              <img 
                [src]="getAvatarUrl(r)" 
                class="table-avatar"
                [alt]="(r.personName || r.name || r.visitorName || 'N/A')"
                (error)="onImageError($event)">
              <span>{{ r.personName || r.name || r.visitorName || 'N/A' }}</span>
            </div>
          </td>
          <td>{{ r.gender || 'N/A' }}</td>
          <td>{{ formatDateTime(r.entryUtc || r.entryTime || r.entryLocal) }}</td>
          <td>
            <span *ngIf="isActive(r)">--</span>
            <span *ngIf="!isActive(r)">{{ formatDateTime(r.exitUtc || r.exitTime || r.exitLocal) }}</span>
          </td>
          <td>
            <span *ngIf="isActive(r)">--</span>
            <span *ngIf="!isActive(r)">{{ formatDwellTime(r.dwellMinutes || r.dwellTime || r.dwell) }}</span>
          </td>
        </tr>
        <tr *ngIf="records.length === 0">
          <td colspan="5" class="no-data">No records found</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="!loading && totalPages > 1" class="pagination">
    <button 
      class="pagination-btn" 
      [disabled]="currentPage === 1"
      (click)="previousPage()">
      Previous
    </button>
    
    <div class="page-numbers">
      <button
        *ngFor="let page of pageNumbers; trackBy: trackByPageNumber"
        class="page-btn"
        [class.active]="page === currentPage"
        [class.ellipsis]="page === '...'"
        [disabled]="page === '...'"
        (click)="page !== '...' && goToPage(page)">
        {{ page }}
      </button>
    </div>
    
    <button 
      class="pagination-btn" 
      [disabled]="currentPage === totalPages"
      (click)="nextPage()">
      Next
    </button>
  </div>

  <div *ngIf="!loading" class="pagination-info">
    Showing {{ (currentPage - 1) * pageSize + 1 }} - {{ Math.min(currentPage * pageSize, totalRecords) }} of {{ totalRecords }} records
  </div>
</div>
